<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:AkademiTrack.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="650"
        x:Class="AkademiTrack.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="AkademiTrack"
        Background="#F8F9FA"
		Height="650"
		Width="900"
        MinWidth="700"
        MinHeight="600">

	<Design.DataContext>
		<vm:MainWindowViewModel/>
	</Design.DataContext>

	<Window.Styles>
		<!-- Force all buttons to always be visible -->
		<Style Selector="Button">
			<Setter Property="IsVisible" Value="True"/>
		</Style>

		<Style Selector="Button:disabled">
			<Setter Property="IsVisible" Value="True"/>
		</Style>

		<!-- Start Button Styles -->
		<Style Selector="Button.start-button">
			<Setter Property="Background" Value="#007ACC"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="CornerRadius" Value="6"/>
			<Setter Property="Padding" Value="20,12"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="MinWidth" Value="160"/>
			<Setter Property="IsVisible" Value="True"/>
		</Style>

		<Style Selector="Button.start-button:pointerover /template/ ContentPresenter">
			<Setter Property="Background" Value="#005A9E"/>
		</Style>

		<!-- Disabled Start Button Style -->
		<Style Selector="Button.start-button:disabled /template/ ContentPresenter">
			<Setter Property="Background" Value="#CCCCCC"/>
			<Setter Property="TextBlock.Foreground" Value="#888888"/>
		</Style>

		<Style Selector="Button.start-button:disabled">
			<Setter Property="IsVisible" Value="True"/>
			<Setter Property="Opacity" Value="1.0"/>
		</Style>

		<!-- Stop Button Styles -->
		<Style Selector="Button.stop-button">
			<Setter Property="Background" Value="#DC3545"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="CornerRadius" Value="6"/>
			<Setter Property="Padding" Value="20,12"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="MinWidth" Value="160"/>
			<Setter Property="IsVisible" Value="True"/>
		</Style>

		<Style Selector="Button.stop-button:pointerover /template/ ContentPresenter">
			<Setter Property="Background" Value="#B02A37"/>
		</Style>

		<!-- Disabled Stop Button Style -->
		<Style Selector="Button.stop-button:disabled /template/ ContentPresenter">
			<Setter Property="Background" Value="#CCCCCC"/>
			<Setter Property="TextBlock.Foreground" Value="#888888"/>
		</Style>

		<Style Selector="Button.stop-button:disabled">
			<Setter Property="IsVisible" Value="True"/>
			<Setter Property="Opacity" Value="1.0"/>
		</Style>

		<Style Selector="Button.settings">
			<Setter Property="Background" Value="#6C757D"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="Medium"/>
			<Setter Property="CornerRadius" Value="6"/>
			<Setter Property="Padding" Value="16,10"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="FontSize" Value="13"/>
			<Setter Property="MinWidth" Value="120"/>
		</Style>

		<Style Selector="Button.settings:pointerover">
			<Setter Property="Background" Value="#545B62"/>
		</Style>

		<Style Selector="Button.log-control">
			<Setter Property="Background" Value="#17A2B8"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="Medium"/>
			<Setter Property="CornerRadius" Value="4"/>
			<Setter Property="Padding" Value="12,8"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="FontSize" Value="12"/>
			<Setter Property="MinWidth" Value="100"/>
		</Style>

		<Style Selector="Button.log-control:pointerover">
			<Setter Property="Background" Value="#138496"/>
		</Style>

		<Style Selector="TextBlock.title">
			<Setter Property="FontSize" Value="32"/>
			<Setter Property="FontWeight" Value="Light"/>
			<Setter Property="Foreground" Value="#212529"/>
			<Setter Property="Margin" Value="0,0,0,8"/>
		</Style>

		<Style Selector="TextBlock.subtitle">
			<Setter Property="FontSize" Value="16"/>
			<Setter Property="FontWeight" Value="Normal"/>
			<Setter Property="Foreground" Value="#6C757D"/>
			<Setter Property="Margin" Value="0,0,0,30"/>
		</Style>

		<Style Selector="TextBlock.info">
			<Setter Property="FontSize" Value="13"/>
			<Setter Property="FontWeight" Value="Normal"/>
			<Setter Property="Foreground" Value="#6C757D"/>
			<Setter Property="Margin" Value="0,0,0,20"/>
			<Setter Property="TextAlignment" Value="Center"/>
		</Style>

		<Style Selector="TextBlock.log-entry">
			<Setter Property="FontFamily" Value="Consolas,Monaco,monospace"/>
			<Setter Property="FontSize" Value="12"/>
			<Setter Property="Padding" Value="4,2"/>
		</Style>

		<Style Selector="TextBlock.log-entry.INFO">
			<Setter Property="Foreground" Value="#495057"/>
		</Style>

		<Style Selector="TextBlock.log-entry.SUCCESS">
			<Setter Property="Foreground" Value="#28A745"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
		</Style>

		<Style Selector="TextBlock.log-entry.ERROR">
			<Setter Property="Foreground" Value="#DC3545"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
		</Style>

		<Style Selector="TextBlock.log-entry.DEBUG">
			<Setter Property="Foreground" Value="#6C757D"/>
			<Setter Property="FontStyle" Value="Italic"/>
		</Style>
	</Window.Styles>

	<Grid Margin="20">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- Header Section -->
		<StackPanel Grid.Row="0" HorizontalAlignment="Center" Spacing="20">

			<!-- App Title -->
			<TextBlock Text="AkademiTrack"
                      Classes="title"
                      HorizontalAlignment="Center"/>

			<TextBlock Text="Automated Attendance System"
                      Classes="subtitle"
                      HorizontalAlignment="Center"/>

			<!-- Info Text -->
			<TextBlock Text="Click Start to begin automated attendance monitoring.&#x0a;The system will handle login and cookie management automatically."
                      Classes="info"
                      HorizontalAlignment="Center"
                      TextWrapping="Wrap"
                      MaxWidth="600"/>

			<!-- Main Control Buttons -->
			<StackPanel Orientation="Horizontal"
                       HorizontalAlignment="Center"
                       Spacing="16">

				<!-- Start button -->
				<Button Content="Start Automation"
                       Classes="start-button"
                       Command="{Binding StartAutomationCommand}"
                       IsEnabled="{Binding !IsAutomationRunning}"
                       ToolTip.Tip="Starts automation with automatic login and cookie management"/>

				<!-- Stop button -->
				<Button Content="Stop Automation"
                       Classes="stop-button"
                       Command="{Binding StopAutomationCommand}"
                       IsEnabled="{Binding IsAutomationRunning}"
                       ToolTip.Tip="Stops the automation process"/>
			</StackPanel>

			<!-- Settings Button -->
			<StackPanel HorizontalAlignment="Center">
				<Button Content="Advanced Settings"
                       Classes="settings"
                       Command="{Binding OpenSettingsCommand}"
                       ToolTip.Tip="Open cookies file location for manual configuration"/>
			</StackPanel>

		</StackPanel>

		<!-- Log Section -->
		<Border Grid.Row="1"
               Background="White"
               CornerRadius="8"
               Padding="20"
               Margin="0,20,0,0"
               BorderThickness="1"
               BorderBrush="#E9ECEF">

			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>

				<!-- Log Header -->
				<Grid Grid.Row="0" Margin="0,0,0,12">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="*"/>
						<ColumnDefinition Width="Auto"/>
					</Grid.ColumnDefinitions>

					<TextBlock Grid.Column="0"
                              Text="Activity Log"
                              FontWeight="SemiBold"
                              FontSize="16"
                              Foreground="#495057"
                              VerticalAlignment="Center"/>

					<StackPanel Grid.Column="1"
                               Orientation="Horizontal"
                               Spacing="8">

						<Button Content="{Binding ShowDetailedLogs, Converter={x:Static vm:BoolToStringConverter.Instance}, ConverterParameter='Hide Debug|Show Debug'}"
                               Classes="log-control"
                               Command="{Binding ToggleDetailedLogsCommand}"
                               ToolTip.Tip="Toggle detailed debug logging"/>

						<Button Content="Clear Logs"
                               Classes="log-control"
                               Command="{Binding ClearLogsCommand}"
                               ToolTip.Tip="Clear all log entries"/>
					</StackPanel>
				</Grid>

				<!-- Current Status -->
				<Border Grid.Row="1"
                       Background="#F8F9FA"
                       CornerRadius="4"
                       Padding="12"
                       Margin="0,0,0,12"
                       BorderThickness="1"
                       BorderBrush="#DEE2E6">

					<StackPanel Spacing="4">
						<TextBlock Text="Current Status:"
                                  FontWeight="SemiBold"
                                  FontSize="12"
                                  Foreground="#6C757D"/>

						<TextBlock Text="{Binding StatusMessage}"
                                  Classes="log-entry"
                                  FontWeight="SemiBold"
                                  Foreground="#495057"/>
					</StackPanel>
				</Border>

				<!-- Log Entries -->
				<ScrollViewer Grid.Row="2"
                             VerticalScrollBarVisibility="Auto"
                             HorizontalScrollBarVisibility="Auto">

					<ItemsControl ItemsSource="{Binding LogEntries}">
						<ItemsControl.ItemTemplate>
							<DataTemplate>
								<TextBlock Text="{Binding FormattedMessage}"
                                          Classes="log-entry"
                                          Classes.INFO="{Binding Level, Converter={x:Static vm:StringEqualityConverter.Instance}, ConverterParameter='INFO'}"
                                          Classes.SUCCESS="{Binding Level, Converter={x:Static vm:StringEqualityConverter.Instance}, ConverterParameter='SUCCESS'}"
                                          Classes.ERROR="{Binding Level, Converter={x:Static vm:StringEqualityConverter.Instance}, ConverterParameter='ERROR'}"
                                          Classes.DEBUG="{Binding Level, Converter={x:Static vm:StringEqualityConverter.Instance}, ConverterParameter='DEBUG'}"
                                          TextWrapping="Wrap"/>
							</DataTemplate>
						</ItemsControl.ItemTemplate>
					</ItemsControl>
				</ScrollViewer>
			</Grid>
		</Border>
	</Grid>
</Window>