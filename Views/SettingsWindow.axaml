<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:AkademiTrack.ViewModels"
        xmlns:services="using:AkademiTrack.Services"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="700"
        x:Class="AkademiTrack.Views.SettingsWindow"
        x:DataType="vm:SettingsViewModel"
        Icon="/Assets/AT-Transparrent.png"
        Title="Innstillinger - AkademiTrack"
        Background="{Binding Source={x:Static services:ThemeManager.Instance}, Path=WindowBackground, Mode=OneWay}"
        Width="900"
        Height="700"
        MinWidth="800"
        MinHeight="600"
        CanResize="True"
        WindowStartupLocation="CenterOwner">
	<Design.DataContext>
		<vm:SettingsViewModel/>
	</Design.DataContext>
	<Window.Styles>
		<!-- Input Field Styles -->
		<Style Selector="TextBox.credential-input">
			<Setter Property="Background" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=InputBackground}"/>
			<Setter Property="Foreground" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextPrimary}"/>
			<Setter Property="CaretBrush" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextPrimary}"/>
			<Setter Property="BorderBrush" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBorder}"/>
			<Setter Property="BorderThickness" Value="1.5"/>
			<Setter Property="CornerRadius" Value="6"/>
			<Setter Property="Padding" Value="12,10"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="MinHeight" Value="40"/>
		</Style>

		<Style Selector="TextBox.credential-input /template/ Border#PART_BorderElement">
			<Setter Property="Background" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=InputBackground}"/>
			<Setter Property="BorderBrush" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBorder}"/>
		</Style>

		<Style Selector="TextBox.credential-input:pointerover /template/ Border#PART_BorderElement">
			<Setter Property="BorderBrush" Value="#007ACC"/>
			<Setter Property="Background" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=InputBackground}"/>
		</Style>

		<Style Selector="TextBox.credential-input:focus /template/ Border#PART_BorderElement">
			<Setter Property="Background" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=InputBackground}"/>
			<Setter Property="BorderBrush" Value="#007ACC"/>
			<Setter Property="BorderThickness" Value="2"/>
		</Style>

		<!-- Category Tab Button Style -->
		<Style Selector="Button.category-tab">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="Foreground" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextSecondary}"/>
			<Setter Property="FontWeight" Value="Medium"/>
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="Padding" Value="16,11"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="CornerRadius" Value="8"/>
			<Setter Property="HorizontalContentAlignment" Value="Left"/>
			<Setter Property="Margin" Value="0,0,0,6"/>
		</Style>

		<Style Selector="Button.category-tab /template/ ContentPresenter#PART_ContentPresenter">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="CornerRadius" Value="8"/>
		</Style>

		<Style Selector="Button.category-tab:pointerover /template/ ContentPresenter#PART_ContentPresenter">
			<Setter Property="Background" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=HoverBackground}"/>
		</Style>

		<Style Selector="Button.category-tab:pointerover">
			<Setter Property="Foreground" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextPrimary}"/>
		</Style>

		<Style Selector="Button.category-tab.selected">
			<Setter Property="Background" Value="#007ACC"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
		</Style>

		<Style Selector="Button.category-tab.selected /template/ ContentPresenter#PART_ContentPresenter">
			<Setter Property="Background" Value="#007ACC"/>
		</Style>

		<Style Selector="Button.category-tab.selected:pointerover /template/ ContentPresenter#PART_ContentPresenter">
			<Setter Property="Background" Value="#005A9E"/>
		</Style>

		<!-- Settings Button Style -->
		<Style Selector="Button.settings-action">
			<Setter Property="Background" Value="#007ACC"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="CornerRadius" Value="8"/>
			<Setter Property="Padding" Value="18,11"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="FontSize" Value="13"/>
			<Setter Property="MinWidth" Value="130"/>
			<Setter Property="HorizontalAlignment" Value="Left"/>
		</Style>

		<Style Selector="Button.settings-action:pointerover">
			<Setter Property="Background" Value="#005A9E"/>
		</Style>

		<!-- Toggle Button Style -->
		<Style Selector="Button.toggle-button">
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="CornerRadius" Value="8"/>
			<Setter Property="Padding" Value="18,11"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="FontSize" Value="13"/>
			<Setter Property="MinWidth" Value="150"/>
			<Setter Property="HorizontalAlignment" Value="Left"/>
		</Style>

		<Style Selector="Button.toggle-button.enabled">
			<Setter Property="Background" Value="#28A745"/>
		</Style>
		<Style Selector="Button.toggle-button.enabled:pointerover">
			<Setter Property="Background" Value="#218838"/>
		</Style>

		<Style Selector="Button.toggle-button.disabled">
			<Setter Property="Background" Value="#DC3545"/>
		</Style>
		<Style Selector="Button.toggle-button.disabled:pointerover">
			<Setter Property="Background" Value="#C82333"/>
		</Style>

		<!-- Cancel/Close Button Style -->
		<Style Selector="Button.cancel">
			<Setter Property="Background" Value="#6C757D"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="Medium"/>
			<Setter Property="CornerRadius" Value="8"/>
			<Setter Property="Padding" Value="20,11"/>
			<Setter Property="BorderThickness" Value="0"/>
			<Setter Property="FontSize" Value="13"/>
			<Setter Property="MinWidth" Value="100"/>
		</Style>
		<Style Selector="Button.cancel:pointerover">
			<Setter Property="Background" Value="#5A6268"/>
		</Style>

		<Style Selector="Button.cancel /template/ ContentPresenter#PART_ContentPresenter">
			<Setter Property="Background" Value="#6C757D"/>
			<Setter Property="CornerRadius" Value="8"/>
		</Style>

		<Style Selector="Button.cancel:pointerover /template/ ContentPresenter#PART_ContentPresenter">
			<Setter Property="Background" Value="#5A6268"/>
		</Style>

		<!-- Section Headers -->
		<Style Selector="TextBlock.section-header">
			<Setter Property="FontSize" Value="18"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="Foreground" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextPrimary}"/>
			<Setter Property="Margin" Value="0,0,0,16"/>
		</Style>

		<!-- Setting Item Headers -->
		<Style Selector="TextBlock.setting-title">
			<Setter Property="FontSize" Value="14"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
			<Setter Property="Foreground" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextPrimary}"/>
			<Setter Property="Margin" Value="0,0,0,4"/>
		</Style>

		<!-- Setting Descriptions -->
		<Style Selector="TextBlock.setting-description">
			<Setter Property="FontSize" Value="12"/>
			<Setter Property="Foreground" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextSecondary}"/>
			<Setter Property="TextWrapping" Value="Wrap"/>
			<Setter Property="Margin" Value="0,0,0,8"/>
		</Style>

		<!-- Info Panel Style -->
		<Style Selector="Border.info-panel">
			<Setter Property="Background" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBackground}"/>
			<Setter Property="BorderBrush" Value="#007ACC"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="CornerRadius" Value="6"/>
			<Setter Property="Padding" Value="12"/>
		</Style>

		<!-- Warning Panel Style -->
		<Style Selector="Border.warning-panel">
			<Setter Property="Background" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBackground}"/>
			<Setter Property="BorderBrush" Value="#FF9800"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="CornerRadius" Value="6"/>
			<Setter Property="Padding" Value="12"/>
		</Style>

		<!-- Setting Item Container -->
		<Style Selector="Border.setting-item">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="Padding" Value="0"/>
			<Setter Property="Margin" Value="0,0,0,16"/>
		</Style>

		<!-- Log Entry Styles -->
		<Style Selector="TextBlock.log-entry">
			<Setter Property="FontFamily" Value="Consolas,Monaco,monospace"/>
			<Setter Property="FontSize" Value="12"/>
			<Setter Property="Padding" Value="6,3"/>
		</Style>
		<Style Selector="TextBlock.log-entry.INFO">
			<Setter Property="Foreground" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextPrimary}"/>
		</Style>
		<Style Selector="TextBlock.log-entry.SUCCESS">
			<Setter Property="Foreground" Value="#28A745"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
		</Style>
		<Style Selector="TextBlock.log-entry.ERROR">
			<Setter Property="Foreground" Value="#DC3545"/>
			<Setter Property="FontWeight" Value="SemiBold"/>
		</Style>
		<Style Selector="TextBlock.log-entry.DEBUG">
			<Setter Property="Foreground" Value="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextSecondary}"/>
			<Setter Property="FontStyle" Value="Italic"/>
		</Style>
	</Window.Styles>

	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="220"/>
			<ColumnDefinition Width="*"/>
		</Grid.ColumnDefinitions>

		<!-- Left Sidebar - Navigation -->
		<Border Grid.Column="0"
				Background="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBackground}"
				BorderBrush="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBorder}"
				BorderThickness="0,0,1.5,0"
				Padding="16,20">
			<StackPanel Spacing="4">
				<TextBlock Text="Innstillinger"
						   FontSize="20"
						   FontWeight="Bold"
						   Foreground="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextPrimary}"
						   Margin="8,0,0,24"/>

				<Button x:Name="LoginButton" Classes="category-tab selected" Content="🔐 Innlogging" Tag="login"/>
				<Button x:Name="AutomationButton" Classes="category-tab" Content="⚙️ Automatisering" Tag="automation"/>
				<Button x:Name="SystemButton" Classes="category-tab" Content="💾 System" Tag="system"/>
				<Button x:Name="AdvancedButton" Classes="category-tab" Content="🛠️ Avansert" Tag="advanced"/>
				<Button x:Name="AboutButton" Classes="category-tab" Content="ℹ️ Om" Tag="about"/>
			</StackPanel>
		</Border>

		<!-- Right Content Area -->
		<Grid Grid.Column="1">
			<Grid.RowDefinitions>
				<RowDefinition Height="*"/>
				<RowDefinition Height="Auto"/>
			</Grid.RowDefinitions>

			<!-- Content ScrollViewer -->
			<ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Padding="24,20,24,20">
				<StackPanel Spacing="16" MaxWidth="600">
					<!-- Login Category -->
					<StackPanel x:Name="LoginSection" Spacing="12">
						<TextBlock Text="Innloggingsinformasjon" Classes="section-header"/>

						<Border Classes="warning-panel" Margin="0,0,0,8">
							<StackPanel Spacing="6">
								<TextBlock Text="🔐 Sikkerhetsinformasjon"
										   FontWeight="SemiBold"
										   FontSize="13"
										   Foreground="#E65100"/>
								<TextBlock Text="Dine innloggingsopplysninger blir automatisk kryptert og lagret sikkert på din datamaskin."
										   FontSize="12"
										   Foreground="#E65100"
										   TextWrapping="Wrap"/>
							</StackPanel>
						</Border>

						<!-- Email Field -->
						<Border Classes="setting-item">
							<StackPanel Spacing="8">
								<TextBlock Text="E-post / Brukernavn" Classes="setting-title"/>
								<TextBlock Text="Din e-postadresse eller brukernavn for FEIDE-innlogging"
										   Classes="setting-description"/>
								<TextBox Text="{Binding LoginEmail}"
										 Classes="credential-input"
										 Watermark="din.epost@elev.drammen.no"/>
							</StackPanel>
						</Border>

						<!-- Password Field -->
						<Border Classes="setting-item">
							<StackPanel Spacing="8">
								<TextBlock Text="Passord" Classes="setting-title"/>
								<TextBlock Text="Ditt passord for FEIDE-innlogging"
										   Classes="setting-description"/>
								<TextBox Text="{Binding LoginPassword}"
										 Classes="credential-input"
										 PasswordChar="•"
										 Watermark="Ditt passord"/>
							</StackPanel>
						</Border>

						<!-- School Name Field -->
						<Border Classes="setting-item">
							<StackPanel Spacing="8">
								<TextBlock Text="Skolenavn" Classes="setting-title"/>
								<TextBlock Text="Navnet på din skole som det vises i FEIDE-organisasjonsvalget"
										   Classes="setting-description"/>
								<TextBox Text="{Binding SchoolName}"
										 Classes="credential-input"
										 Watermark="Akademiet Drammen AS"/>
							</StackPanel>
						</Border>
					</StackPanel>

					<!-- Automation Category -->
					<StackPanel x:Name="AutomationSection" Spacing="12" IsVisible="False">
						<TextBlock Text="Automatisering" Classes="section-header"/>

						<Border Classes="setting-item">
							<StackPanel Spacing="8">
								<TextBlock Text="Start automatisering ved oppstart" Classes="setting-title"/>
								<TextBlock Text="Automatiseringen starter automatisk når programmet åpnes. Perfekt for å aldri glemme å registrere STU-timer."
										   Classes="setting-description"/>
								<Button Content="{Binding AutoStartAutomation, Converter={x:Static vm:BoolToStringConverter.Instance}, ConverterParameter='Aktivert|Deaktivert'}"
										Classes="toggle-button"
										Classes.enabled="{Binding AutoStartAutomation}"
										Classes.disabled="{Binding !AutoStartAutomation}"
										Command="{Binding ToggleAutoStartAutomationCommand}"/>
							</StackPanel>
						</Border>
					</StackPanel>

					<!-- System Category -->
					<StackPanel x:Name="SystemSection" Spacing="12" IsVisible="False">
						<TextBlock Text="Systemintegrasjon" Classes="section-header"/>

						<Border Classes="setting-item">
							<StackPanel Spacing="8">
								<TextBlock Text="Start med Windows" Classes="setting-title"/>
								<TextBlock Text="Automatisk start av AkademiTrack når datamaskinen starter opp."
										   Classes="setting-description"/>
								<Button Content="{Binding StartWithSystem, Converter={x:Static vm:BoolToStringConverter.Instance}, ConverterParameter='Aktivert|Deaktivert'}"
										Classes="toggle-button"
										Classes.enabled="{Binding StartWithSystem}"
										Classes.disabled="{Binding !StartWithSystem}"
										Command="{Binding ToggleAutoStartCommand}"/>
							</StackPanel>
						</Border>

						<Border Classes="setting-item">
							<StackPanel Spacing="8">
								<TextBlock Text="Programfiler" Classes="setting-title"/>
								<TextBlock Text="Tilgang til programmappen der cookies og konfigurasjonsfiler lagres."
										   Classes="setting-description"/>
								<Button Content="Åpne Programmappe"
										Classes="settings-action"
										Command="{Binding OpenProgramFolderCommand}"/>
							</StackPanel>
						</Border>
					</StackPanel>

					<!-- Advanced Category -->
					<StackPanel x:Name="AdvancedSection" Spacing="12" IsVisible="False">
						<TextBlock Text="Avanserte innstillinger" Classes="section-header"/>

						<Border Classes="setting-item">
							<StackPanel Spacing="8">
								<TextBlock Text="Aktivitetslogg" Classes="setting-title"/>
								<TextBlock Text="Vis teknisk aktivitetslogg for feilsøking og diagnostikk."
										   Classes="setting-description"/>
								<Button Content="{Binding ShowActivityLog, Converter={x:Static vm:BoolToStringConverter.Instance}, ConverterParameter='Vis logg|Skjul logg'}"
										Classes="settings-action"
										Command="{Binding ToggleActivityLogCommand}"/>
							</StackPanel>
						</Border>

						<!-- Activity Log Panel -->
						<Border Background="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBackground}"
								BorderBrush="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBorder}"
								BorderThickness="1"
								CornerRadius="6"
								Padding="16"
								IsVisible="{Binding ShowActivityLog}">
							<Grid>
								<Grid.RowDefinitions>
									<RowDefinition Height="Auto"/>
									<RowDefinition Height="Auto"/>
								</Grid.RowDefinitions>

								<Grid Grid.Row="0" Margin="0,0,0,12">
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="*"/>
										<ColumnDefinition Width="Auto"/>
									</Grid.ColumnDefinitions>
									<TextBlock Grid.Column="0"
											   Text="Aktivitetslogg"
											   FontWeight="SemiBold"
											   FontSize="14"
											   Foreground="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextPrimary}"/>
									<Button Grid.Column="1"
											Content="Tøm logg"
											Classes="settings-action"
											Command="{Binding ClearLogsCommand}"
											Padding="12,8"
											MinWidth="90"/>
								</Grid>

								<Border Grid.Row="1"
										Background="{Binding Source={x:Static services:ThemeManager.Instance}, Path=InputBackground}"
										BorderBrush="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBorder}"
										BorderThickness="1"
										CornerRadius="6"
										Height="280">
									<ScrollViewer VerticalScrollBarVisibility="Auto" Padding="8">
										<ItemsControl ItemsSource="{Binding LogEntries}">
											<ItemsControl.ItemTemplate>
												<DataTemplate>
													<TextBlock Text="{Binding FormattedMessage}"
															   Classes="log-entry"
															   Classes.INFO="{Binding Level, Converter={x:Static vm:StringEqualityConverter.Instance}, ConverterParameter='INFO'}"
															   Classes.SUCCESS="{Binding Level, Converter={x:Static vm:StringEqualityConverter.Instance}, ConverterParameter='SUCCESS'}"
															   Classes.ERROR="{Binding Level, Converter={x:Static vm:StringEqualityConverter.Instance}, ConverterParameter='ERROR'}"
															   Classes.DEBUG="{Binding Level, Converter={x:Static vm:StringEqualityConverter.Instance}, ConverterParameter='DEBUG'}"
															   TextWrapping="Wrap"/>
												</DataTemplate>
											</ItemsControl.ItemTemplate>
										</ItemsControl>
									</ScrollViewer>
								</Border>
							</Grid>
						</Border>
					</StackPanel>

					<!-- About Category -->
					<StackPanel x:Name="AboutSection" Spacing="12" IsVisible="False">
						<TextBlock Text="Om AkademiTrack" Classes="section-header"/>

						<Border Classes="info-panel">
							<StackPanel Spacing="8">
								<TextBlock Text="📱 Applikasjonsinformasjon"
										   FontWeight="SemiBold"
										   FontSize="14"
										   Foreground="#007ACC"/>
								<TextBlock Text="{Binding ApplicationInfo}"
										   FontSize="12"
										   Foreground="{Binding Source={x:Static services:ThemeManager.Instance}, Path=TextPrimary}"
										   TextWrapping="Wrap"/>
							</StackPanel>
						</Border>
					</StackPanel>
				</StackPanel>
			</ScrollViewer>

			<!-- Footer Buttons -->
			<Border Grid.Row="1"
					Background="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBackground}"
					BorderBrush="{Binding Source={x:Static services:ThemeManager.Instance}, Path=CardBorder}"
					BorderThickness="0,1.5,0,0"
					Padding="32,16">
				<StackPanel Orientation="Horizontal"
							HorizontalAlignment="Right"
							Spacing="12">
					<Button Content="Lukk"
							Classes="cancel"
							Command="{Binding CloseCommand}"
							IsDefault="True"/>
				</StackPanel>
			</Border>
		</Grid>
	</Grid>
</Window>